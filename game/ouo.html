<!DOCTYPE html>
<html>
<head>
    <title>game</title>
    <script src="phaser.min.js"></script>
    <style>
        #web{
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #zone{
            display: flex;
            justify-content: center;
            align-items: center; 
            width: 1200px;
            height: 600px;
        }
        #Information{
            background-color: gray;
            width: 200px;
            height: 600px;
            font-size: 12.5px;
        }        
        #game-container{
            width : 800px;
            height : 600px;
            background-color: black;

        }
    </style>
</head>
<body id="web"><!--基礎物件-->
    <div id="zone">
        <div id="Information"></div>
        <div id="game-container"></div>
        <div id="Information"></div>
    </div>
</body>
<body>
    <script>

        var platform;
        var graphics;
        var config = {              //物件屬性
            type: Phaser.AUTO,      //自動選擇為最好的渲染方式
            width: 800,             //寬高設定
            height: 600,
            parent: 'game-container',
            physics: {              //加入物理模塊
                default: 'arcade',
                arcade: {
                    gravity: { y: 300 },
                    debug: false
                }
            },
            scene: {                
                preload: preload,   //加載資料
                create: create,     //創建畫面
                update: update,     //刷新畫面
            }
        };

        
        var Magic_poker={
            defaultColor:0xffffff,
            hoverColor : 0x00ffff,
            Player_Attributes:0xFFFF00,
            enemy_Attributes:0xFF0000,
            Role_face:['dust_face','fire_face','water_face','wind_face'],

            drawzone(scene){                            //繪製卡牌放置區
                var rectGraphics = scene.add.graphics();
                rectGraphics.fillStyle(0x444444, 1);
                rectGraphics.fillRect(0, 0, 800, 600);
                rectGraphics.fillStyle(0xDDDDDD, 1);
                rectGraphics.fillRect(0, 0, 800, 100);
                
                for (var row = 0; row < 2; row++) for (var col = 0; col < 5; col++) {
                    var x = 80 + col * 100;
                    var y = 130 + row * 156;
                    var width = 64;
                    var height = 96;
                    var radius = 20;
                    var defaultColor = this.defaultColor;
                    var hoverColor = this.hoverColor;

                    var graphics = scene.add.graphics();

                    graphics.lineStyle(2, this.defaultColor);
                    graphics.strokeRoundedRect(x, y, width, height, radius);
                    
                    graphics.setInteractive(new Phaser.Geom.Rectangle(x, y, width, height), Phaser.Geom.Rectangle.Contains);
                    (function (graphics, x, y, width, height, radius) {
                        graphics.on('pointerover', function () {    // 添加鼠标移上事件
                            graphics.lineStyle(2, hoverColor);
                            graphics.strokeRoundedRect(x, y, width, height, radius);
                        });
                        graphics.on('pointerout', function () {     // 添加鼠标移出事件
                            graphics.lineStyle(2, defaultColor);
                            graphics.strokeRoundedRect(x, y, width, height, radius);
                        });
                    })(graphics, x, y, width, height, radius);
                }

            },
            createPlayerUI(scene, isPlayer) {
                var x = 60;
                var y = 50;
                var radius = 50;


                // 头像图片
                var avatar = scene.add.image(isPlayer ? 0 : config.width - x - radius , -20 , isPlayer ? 'dust_face2' : 'fire_face2');
                avatar.displayWidth =120;
                avatar.displayHeight=120;
                avatar.setOrigin(0, 0);
                
                var graphics = scene.add.graphics();

                graphics.beginPath();
                graphics.moveTo(x + radius, y);
                graphics.arc(x, y, radius, 0, Phaser.Math.PI2 / 4, false);
                graphics.lineTo(config.width - x, y+radius);
                graphics.arc(config.width - x, y, radius, Phaser.Math.PI2 / 4, Phaser.Math.PI2 / 2, false);
                graphics.lineTo(config.width - x - radius, 0);
                graphics.lineTo(x+radius, 0);
                graphics.lineTo(x+radius, y);
                graphics.closePath();
                graphics.fillStyle(0xffffff,1)
                graphics.fillPath();


                // HP 文本
                var hpText = scene.add.text(100, 0, '', {
                    fontSize: '20px',
                    fill: '#000',
                    align: 'center'
                });
                hpText.setOrigin(0.5, 0.5);

                

                // 更新 HP 文本
                this.updateHPText = function () {
                    hpText.setText('HP: ' + (isPlayer ? this.playerHP : this.enemyHP));
                };

            }
        }

        var game = new Phaser.Game(config);

        function preload(){
            for(let i=0;i<4;i++)
                for(let j=1;j<=3;j++)
                    this.load.image(`${Magic_poker.Role_face[i]}${j}`,`portrait/${Magic_poker.Role_face[i]}${j}.png`)
        }

        function create(){

            Magic_poker.drawzone(this);
            Magic_poker.createPlayerUI(this, true);     // 玩家
            Magic_poker.createPlayerUI(this, false);    // 敌人
            
            // Magic_poker.updateHPText();                 // 初始化 HP 文本

        }
        
        function update(){

        }
    
    </script>
</body>
</html>
